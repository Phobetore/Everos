{{ $currentPage := . }}
<<<<<<< HEAD
<nav class="main-nav{{ if not $currentPage.IsSection }} scrolled{{ end }}" style="{{ if not $currentPage.IsSection }} position: relative !important;{{ end }}">
=======
{{/* Définir les pages racines qui doivent avoir une navbar transparente */}}
{{ $rootPages := slice "/pages/universe/" "/pages/deities/" "/pages/chronicles/" "/pages/game-systems/" "/pages/gallery/" "/pages/collective/" }}
{{ $isRootPage := or $currentPage.IsHome (and $currentPage.IsSection (in $rootPages $currentPage.RelPermalink)) }}
<nav class="main-nav{{ if not $isRootPage }} scrolled{{ end }}" style="{{ if not $isRootPage }} position: relative !important;{{ end }}">
>>>>>>> 61e94b9822417ab1a3d8c2a27208103d9af5cb7f
    <div class="nav-container">
        <div class="logo-container">
            <a href="{{ "/" | relURL }}" class="logo">EVEROS</a>
        </div>
        <div class="menu-toggle">
            <i class="fas fa-bars"></i>
        </div>
        <ul class="nav-menu">
          {{ range .Site.Menus.main }}
            {{/* Cas spécial: le parent "Divinités & Royaumes" est rempli depuis data/divinites.yaml */}}
            {{ if eq .Identifier "deities" }}
              <li>
                <a href="{{ .URL | relURL }}" class="nav-link{{ if $currentPage.IsMenuCurrent "main" . }} active{{ end }}">
                  {{ .Name }}
                </a>
                <div class="dropdown-content">
                  {{ $deities := site.Data.divinites }}
                  {{ if $deities }}
                    {{ range sort $deities "name" }}
                      <a href="{{ printf "/pages/deities/%s/" .slug | relURL }}">{{ .name }}</a>
                    {{ end }}
                  {{ else }}
                    <span class="dropdown-empty">Aucune divinité disponible</span>
                  {{ end }}
                </div>
              </li>

            {{ else if .HasChildren }}
              <li>
                <a href="{{ .URL | relURL }}" class="nav-link{{ if $currentPage.IsMenuCurrent "main" . }} active{{ end }}">{{ .Name }}</a>
                <div class="dropdown-content">
                  {{ range .Children }}
                    <a href="{{ .URL | relURL }}"{{ if $currentPage.IsMenuCurrent "main" . }} class="active"{{ end }}>{{ .Name }}</a>
                  {{ end }}
                </div>
              </li>

            {{ else }}
              <li>
                <a href="{{ .URL | relURL }}" class="nav-link{{ if $currentPage.IsMenuCurrent "main" . }} active{{ end }}">{{ .Name }}</a>
              </li>
            {{ end }}
          {{ end }}
        </ul>
    </div>
</nav>

<<<<<<< HEAD
{{ if $currentPage.IsSection }}
=======
{{ if $isRootPage }}
>>>>>>> 61e94b9822417ab1a3d8c2a27208103d9af5cb7f
<script>
    // Navigation sticky au scroll (sur la home et les pages racines)
    const mainNav = document.querySelector('.main-nav');
    window.addEventListener('scroll', function() {
        if (window.scrollY > 100) {
            mainNav.classList.add('scrolled');
        } else {
            mainNav.classList.remove('scrolled');
        }
    });
</script>
{{ end }}