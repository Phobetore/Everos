{{ $deities := .Site.Data.divinites }}

<!-- Page-specific styles -->
<style>
    /* Styles spécifiques à la page des divinités */
    .deities-hero {
        height: 50vh;
        min-height: 400px;
        background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                    url('https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80') no-repeat center center;
        background-size: cover;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        color: var(--text-light);
    }
    
    .deities-hero-content {
        max-width: 800px;
        padding: 0 var(--spacing-md);
    }
    
    .deities-hero-content h1 {
        font-size: 4.8rem;
        color: var(--text-light);
        margin-bottom: var(--spacing-sm);
    }
    
    .deities-hero-content p {
        font-size: 2rem;
        margin-bottom: var(--spacing-md);
    }
    
    .deities-overview {
        padding: var(--spacing-lg) 0;
        max-width: 1200px;
        margin: 0 auto;
    }
    
    .cosmic-map {
        text-align: center;
        margin-bottom: var(--spacing-lg);
    }
    
    .cosmic-map-container {
        position: relative;
        max-width: 800px;
        margin: 0 auto;
    }
    
    .cosmic-map img {
        width: 100%;
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }
    
    .deity-card {
        margin-bottom: var(--spacing-md);
        background-color: #fff;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
        display: flex;
        flex-direction: column;
        height: 100%;
    }
    
    .deity-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
    }
    
    .deity-card-image {
        height: 250px;
        overflow: hidden;
    }
    
    .deity-card-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
    }
    
    .deity-card:hover .deity-card-image img {
        transform: scale(1.05);
    }
    
    .deity-card-content {
        padding: var(--spacing-md);
        display: flex;
        flex-direction: column;
        flex-grow: 1;
    }
    
    .deity-card-content h3 {
        font-size: 2.4rem;
        margin-bottom: var(--spacing-sm);
        color: var(--primary-dark);
    }
    
    .deity-domain {
        font-style: italic;
        color: var(--text-medium);
        margin-bottom: var(--spacing-sm);
        font-size: 1.6rem;
    }
    
    .deity-description {
        margin-bottom: var(--spacing-md);
        flex-grow: 1;
    }
    
    .deity-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: var(--spacing-md);
        padding: 0 var(--spacing-md);
    }
    
    .deity-relations {
        padding: var(--spacing-lg) 0;
        background-color: var(--primary-medium);
        color: var(--text-light);
    }
    
    .relations-diagram {
        max-width: 1000px;
        margin: 0 auto;
        padding: var(--spacing-md);
        position: relative;
        min-height: 500px;
    }
    
    .relation-line {
        position: absolute;
        height: 2px;
        background-color: var(--accent-gold);
        transform-origin: 0 0;
    }
    
    .relation-positive {
        background-color: var(--accent-blue);
    }
    
    .relation-negative {
        background-color: var(--accent-red);
    }
    
    .relation-neutral {
        background-color: var(--accent-gold);
    }
    
    .relation-label {
        position: absolute;
        background-color: var(--primary-dark);
        padding: 0.5rem 1rem;
        border-radius: 4px;
        font-size: 1.2rem;
        white-space: nowrap;
    }
</style>

<section class="deities-hero">
    <div class="deities-hero-content">
        <h1>{{ .Title }}</h1>
        <p>{{ .Description | default "Découvrez les sept divinités puissantes qui règnent sur Everos" }}</p>
    </div>
</section>

<section class="deities-overview">
    <div class="pantheon-intro">
        <h2 class="section-title">Le Panthéon Divin</h2>
        {{ if .Content }}
        <div class="section-description">
            {{ .Content }}
        </div>
        {{ else }}
        <p class="section-description">Sept divinités puissantes règnent sur Everos, chacune maîtresse de son propre continent et de ses domaines spécifiques. Leurs influences façonnent non seulement la géographie mais aussi la culture, la magie et le destin de tous les êtres vivants.</p>
        {{ end }}
        <br>
        
        <div class="deity-grid">
            {{ range $deities }}
            <!-- {{ .name }} -->
            <div class="deity-card">
                <div class="deity-card-image">
                    <img src="{{ .image }}" alt="{{ .name }}" loading="lazy">
                </div>
                <div class="deity-card-content">
                    <h3>{{ .name }}</h3>
                    <div class="deity-domain">{{ .domain }}</div>
                    <div class="deity-description">
                        <p>{{ .short_description }}</p>
                    </div>
                    <a href="{{ printf "/pages/deities/%s/" .slug | relURL }}" class="btn">Découvrir</a>
                </div>
            </div>
            {{ end }}
        </div>
    </div>
</section>

<section class="deity-relations">
    <div class="relations-container">
        <h2 class="section-title">Relations Divines</h2>
        
        <div class="relations-diagram" id="relations-diagram">
            <!-- Le diagramme sera généré dynamiquement par JavaScript -->
        </div>
    </div>
</section>

<!-- CSS et JS pour les relations divines -->
<link rel="stylesheet" href="{{ "css/divine-relations.css" | relURL }}">

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Données des divinités depuis Hugo
    const deities = [
        {{ range $index, $deity := $deities }}
        {{ if $index }},{{ end }}
        {
            name: "{{ .name }}",
            slug: "{{ .slug }}",
            image: "{{ .image }}",
            colors: {
                primary: "{{ .colors.primary }}",
                secondary: "{{ .colors.secondary }}",
                accent: "{{ .colors.accent }}",
                text: "{{ .colors.text }}",
                light: "{{ .colors.light }}"
            }
        }
        {{ end }}
    ];

    // Relations entre les divinités depuis les données YAML
    const relations = [
        {{ range $relation := site.Data.relations.relations }}
        {
            from: "{{ .from }}",
            to: "{{ .to }}",
            type: "{{ .type }}",
            description: "{{ .description }}",
            details: "{{ .details }}"
        },
        {{ end }}
    ];
    
    // Rendre les données disponibles globalement pour le script
    window.deitiesData = deities;
    window.relationsData = relations;
    
    // Initialiser le diagramme des relations divines
    if (typeof DivineRelationsDiagram !== 'undefined') {
        new DivineRelationsDiagram('relations-diagram', deities, relations);
    }
});
</script>

<script src="{{ "js/divine-relations.js" | relURL }}"></script>